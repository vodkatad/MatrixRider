added s4vectors in linkingto and now it compiles on docker (it had stopped
with the usual error) but is complaining about the seq member of the Chars_holder
struct? (try to rm the cped .h in the real machine)

cp /home/data/R/x86_64-pc-linux-gnu-library/3.1/S4Vectors/include/S4Vectors_defines.h /home/data/R/x86_64-pc-linux-gnu-library/3.1/Biostrings/include/

** libs
gcc -std=gnu99 -I/usr/local/lib/R/include -DNDEBUG  -I/usr/local/include -I"    IRanges/include" -I"/usr/local/lib/R/library/XVector/include" -I"/     usr/local/lib/R/library/Biostrings/include"   -fpic  -g -O2  -c Biostring_stubs.c -o Biostring_stubs.o
In file included from /usr/local/lib/R/library/Biostrings/include/Biostrings_defines.h:18:0,
                 from /usr/local/lib/R/library/Biostrings/include/Biostrings_interface.h:114,
                 from /usr/local/lib/R/library/Biostrings/include/_Biostrings_stubs.c:1,
                 from Biostring_stubs.c:1:
/usr/local/lib/R/library/IRanges/include/IRanges_defines.h:18:31: fatal error: S4Vectors_defines.h: No such file or directory
 #include "S4Vectors_defines.h"
                               ^
compilation terminated.

/usr/local/lib/R/library/S4Vectors/include/S4Vectors_defines.h has the Chars_holder instead of XVectors?
and there the struct has ptr and not seq!

Error in is(object, Cl) : 
  no slot of name "shared" for this object of class "standardGeneric" 

subject is a bad name!


e il C liscio di matrix_rider senza -n restituisce na in caso di affinity zero 
(cutoff alti con -y -w -1)

TODO: 
man pages
vignette with biocstyle
[manage other bjects: MaskedDNAStrings or XStringViews]
object checks and so on (in R)
unit tests (in C and not in R would be the idea but how...?)
multiple matrixes method

#setMethod("searchSeq", "PWMatrixList",
# scans a nucleotide sequence with 
# all patterns represented stored in $matrixset;
#          function(x, subject, seqname="Unknown", 
#                   strand="*", min.score="80%"){
            #pwms = lapply(Matrix(x), unitScale)
            #ans = lapply(pwms, matchPWM, subject, min.score)
#            ans_list = lapply(x, searchSeq, 
#                              subject=subject, seqname=seqname, 
#                              strand=strand, min.score=min.score)
#            ans = do.call(SiteSetList, ans_list)
            #ans = SiteSetList(ans_list)
#            return(ans)
#          }
#          )


    A \code{DNAString}, \code{XStringViews} or \code{MaskedDNAString} object which will be scanned.

For XStringViews and MaskedDNAString it does not work right now (no slot of name shared 
for this object of class MaskedDNAString) --> forced it to get only DNAString for now.

cp /home/data/R/x86_64-pc-linux-gnu-library/3.1/S4Vectors/include/S4Vectors_defines.h /home/data/R/x86_64-pc-linux-gnu-library/3.1/Biostrings/include/



data@femto:~/Dropbox/work/matrix/matrix_rider$ time ./matrix_rider -m  /rogue/molineri/bioinfotree//task/binding_sites/dataset/jaspar/20091019/core.count -f /home/data/work/matrix/prova.fa -b /home/data/work/matrix/bg > /home/data/work/matrix/cutoff0.byfastC

real   0m0.040s
user	0m0.032s
sys	0m0.008s

data@femto:~/Dropbox/work/matrix/matrix_rider$ time ./matrix_rider -w -1 -y -p 0.0 -n -m /rogue/molineri/bioinfotree//task/binding_sites/dataset/jaspar/20091019/core.count -f /home/data/work/matrix/prova.fa -b /home/data/work/matrix/bg > /home/data/work/matrix/cutoff0.byC

real   0m0.056s
user	0m0.044s
sys	0m0.008s

data@femto:~/Dropbox/work/matrix/mr_bioc/matrix_rider/inst/examples$ time ./MatrixRiderWrapper.R  -f /home/data/work/matrix/prova.fa -c 0 > /home/data/work/matrix/cutoff0.byR
Loading required package: methods
Warning message:
replacing previous import by ‘graphics::plot’ when loading ‘seqLogo’ 
Loading required package: Biostrings
Loading required package: BiocGenerics
Loading required package: parallel

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:parallel’:

    clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,
    clusterExport, clusterMap, parApply, parCapply, parLapply,
    parLapplyLB, parRapply, parSapply, parSapplyLB

The following object is masked from ‘package:stats’:

    xtabs

The following objects are masked from ‘package:base’:

    anyDuplicated, append, as.data.frame, as.vector, cbind, colnames,
    do.call, duplicated, eval, evalq, Filter, Find, get, intersect,
    is.unsorted, lapply, Map, mapply, match, mget, order, paste, pmax,
    pmax.int, pmin, pmin.int, Position, rank, rbind, Reduce, rep.int,
    rownames, sapply, setdiff, sort, table, tapply, union, unique,
    unlist, unsplit

Loading required package: S4Vectors
Loading required package: stats4
Loading required package: IRanges
Loading required package: XVector

real   0m18.515s
user	0m18.220s
sys	0m0.272s
