added s4vectors in linkingto and now it compiles on docker (it had stopped
with the usual error) but is complaining about the seq member of the Chars_holder
struct? (try to rm the cped .h in the real machine)

cp /home/data/R/x86_64-pc-linux-gnu-library/3.1/S4Vectors/include/S4Vectors_defines.h /home/data/R/x86_64-pc-linux-gnu-library/3.1/Biostrings/include/

** libs
gcc -std=gnu99 -I/usr/local/lib/R/include -DNDEBUG  -I/usr/local/include -I"    IRanges/include" -I"/usr/local/lib/R/library/XVector/include" -I"/     usr/local/lib/R/library/Biostrings/include"   -fpic  -g -O2  -c Biostring_stubs.c -o Biostring_stubs.o
In file included from /usr/local/lib/R/library/Biostrings/include/Biostrings_defines.h:18:0,
                 from /usr/local/lib/R/library/Biostrings/include/Biostrings_interface.h:114,
                 from /usr/local/lib/R/library/Biostrings/include/_Biostrings_stubs.c:1,
                 from Biostring_stubs.c:1:
/usr/local/lib/R/library/IRanges/include/IRanges_defines.h:18:31: fatal error: S4Vectors_defines.h: No such file or directory
 #include "S4Vectors_defines.h"
                               ^
compilation terminated.

/usr/local/lib/R/library/S4Vectors/include/S4Vectors_defines.h has the Chars_holder instead of XVectors?
and there the struct has ptr and not seq!

Error in is(object, Cl) : 
  no slot of name "shared" for this object of class "standardGeneric" 

subject is a bad name!


e il C liscio di matrix_rider senza -n restituisce na in caso di affinity zero 
(cutoff alti con -y -w -1)

TODO: 
man pages
vignette with biocstyle
check for other DNAstring objects
object checks and so on (in R)
unit tests (in C and not in R would be the idea but how...?)
multiple matrixes method

setMethod("searchSeq", "PWMatrixList",
# scans a nucleotide sequence with 
# all patterns represented stored in $matrixset;
          function(x, subject, seqname="Unknown", 
                   strand="*", min.score="80%"){
            #pwms = lapply(Matrix(x), unitScale)
            #ans = lapply(pwms, matchPWM, subject, min.score)
            ans_list = lapply(x, searchSeq, 
                              subject=subject, seqname=seqname, 
                              strand=strand, min.score=min.score)
            ans = do.call(SiteSetList, ans_list)
            #ans = SiteSetList(ans_list)
            return(ans)
          }
          )


    A \code{DNAString}, \code{XStringViews} or \code{MaskedDNAString} object which will be scanned.

For XStringViews and MaskedDNAString it does not work right now (no slot of name shared 
for this object of class MaskedDNAString) --> forced it to get only DNAString for now.

cp /home/data/R/x86_64-pc-linux-gnu-library/3.1/S4Vectors/include/S4Vectors_defines.h /home/data/R/x86_64-pc-linux-gnu-library/3.1/Biostrings/include/
